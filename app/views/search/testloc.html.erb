<head>

  <script type="text/javascript"
          src="https://maps.googleapis.com/maps/api/js?&sensor=true">
  </script>

  <script type="text/javascript">

      function getLocation(){
          {
              if (navigator.geolocation)
              {
                  navigator.geolocation.getCurrentPosition(showPosition);
              }
              else{x.innerHTML="Geolocation is not supported by this browser.";}
          }

      }

      function showPosition(position) {
          var latitude  = position.coords.latitude;
          var longitude = position.coords.longitude;

          //alert('latitude:' + latitude + 'longitude:' + longitude )
//document.getElementById("latitude").innerHTML = latitude.toString();


function sendParams(q){
  $.ajax({
    url: 'testloc',
    type: 'GET',
    data:     {'la':'38', 'lo':'-97'}
  });
}
sendParams("test");

<%
require 'active_support'
print "\n\n\n\n\n=========123============="
#laa=ActiveSupport::JSON.decode(CGI.unescapeHTML(params[:la]))
print params[:la]
print "===321"
cookies[:la]=params[:la]
cookies[:lo]=params[:lo]
%>


       //   This function is supposed to return the current latitude and longitude of user
       //   example: 48.1673341, 17.0830998

      }


      function initialize() {

          var mapOptions = {


         //    How to pass the result from function showPosition to LatLng ?
         //    see the line below:                
         center: new google.maps.LatLng(48.1673341,17.0830998),
              zoom: 13,
              mapTypeId: google.maps.MapTypeId.ROADMAP
          };
          var map = new google.maps.Map(document.getElementById("map-canvas"),
                  mapOptions);

      }

      google.maps.event.addDomListener(window, 'load', initialize);

  $(document).ready(function(){     //  events before the windows loads
    getLocation();

  });


  </script>

</head>


<h3 id="latitude">Hello, <%=cookies[:username]%> </h3>


<%=link_to "Enter site!", "/", :id => 'new_building_link' %>



<div id="map-canvas"/>